---
title: "Delete Detected Files"
last_modified_at: 2021-03-29
toc: true
toc_label: ""
tags:
  - Response
  - Splunk SOAR
  - Windows Remote Management
---

[Try in Splunk SOAR](https://www.splunk.com/en_us/software/splunk-security-orchestration-and-automation.html){: .btn .btn--success}

#### Description

This playbook acts upon events where a file has been determined to be malicious (ie webshells being dropped on an end host). Before deleting the file, we run a &#34;more&#34; command on the file in question to extract its contents. We then run a delete on the file in question.

- **Type**: Response
- **Product**: Splunk SOAR
- **Apps**: [Windows Remote Management](https://splunkbase.splunk.com/apps?keyword=windows+remote+management&filters=product%3Asoar)
- **Last Updated**: 2021-03-29
- **Author**: Philip Royer, Splunk
- **ID**: fc0edc96-ff2b-48b0-9a6f-63da6783fd63
- **Use-cases**:

#### Associated Detections



























































































































































































































































































































































































































* [Executable File Written in Administrative SMB Share](/endpoint/f63c34fe-a435-11eb-935a-acde48001122/)






















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#### How To Implement
This playbook reads and then deletes files stored with artifact:*.cef.filePath from hosts stored in artifact:*.cef.destinationAddress. Windows Remote Management must be enabled on the remote computer.


#### Explore Playbook

![explore](https://raw.githubusercontent.com/splunk/security_content/develop/playbooks/delete_detected_files.png)

#### Required field
* filePath
* destinationAddress


#### Reference



[*source*](https://github.com/splunk/security_content/tree/develop/playbooks/delete_detected_files.yml) \| *version*: **1**